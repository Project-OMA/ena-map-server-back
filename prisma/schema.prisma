generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-1.0.x"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id    Int       @id @default(autoincrement())
  sub   String    @default(uuid())
  name    String       @db.VarChar(255)
  email         String       @db.VarChar(255)
  password      String       @db.VarChar(255)
  type          Int       
  created_at    DateTime     @default(now())
  updated_at    DateTime     @updatedAt
  
  rel_user_group UserGroup[]
  map   Map[]
  group         Group[]

  @@map("tb_user")
}


model UserGroup {
  id_user Int
  id_group Int
  user User @relation(fields: [id_user], references: [id])
  group   Group @relation(fields: [id_group], references: [id])

  @@id([id_user, id_group])
  @@index([id_user], map: "rel_user_group_id_user_fkey")
  @@index([id_group], map: "rel_user_group_id_group_fkey")

  @@map("rel_user_group")
}


model Group {
  id     Int       @id @default(autoincrement())
  name      String       @db.VarChar(255)
  id_owner      Int       
  created_at    DateTime     @default(now())
  updated_at    DateTime     @updatedAt
  user   User @relation(fields: [id_owner], references: [id])

  rel_group_map GroupMap[]
  rel_user_group  UserGroup[]

  @@index([id_owner], map: "tb_group_id_owner_fkey")
  @@map("tb_group")
}

model GroupMap {
  id_group Int
  id_map    Int
  order     Json
  group   Group @relation(fields: [id_group], references: [id])
  map      Map @relation(fields: [id_map], references: [id])

  @@id([id_group, id_map])
  @@index([id_group], map: "rel_user_map_id_group_fkey")
  @@index([id_map], map: "rel_user_map_id_map_fkey")
  @@map("rel_group_map")
}

model Map {
  id       Int       @id @default(autoincrement())
  id_owner      Int       
  name        String       @db.VarChar(255)
  thumb_url     String     @db.VarChar(255)
  url       String       @db.VarChar(255)
  tag    Json
  created_at    DateTime     @default(now())
  updated_at    DateTime     @updatedAt
  userOwner  User   @relation(fields: [id_owner], references: [id])
  rel_group_map GroupMap[]

  @@index([id_owner], map: "tb_map_id_owner_fkey")
  @@map("tb_map")
}